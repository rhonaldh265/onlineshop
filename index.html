<!DOCTYPE html>
<html>
<head>
  <title>Classic Shop</title>
  <link rel="stylesheet" href="style.css">
  <style>
    .product-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap: 20px;
    }
    .product-card {
      background: #fff;
      padding: 10px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      transition: transform 0.3s ease;
    }
    .product-card:hover {
      transform: scale(1.05);
    }
    .product-card img {
      max-width: 100%;
      border-radius: 6px;
      cursor: pointer;
    }
    .admin-button {
      position: absolute;
      top: 10px;
      right: 10px;
      padding: 8px;
      background: #333;
      color: #fff;
      text-decoration: none;
      border-radius: 4px;
    }
    button {
      margin-top: 8px;
      padding: 6px 12px;
      background: #007bff;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    button:hover {
      background: #0056b3;
    }
  </style>
</head>
<body>
  <!-- Admin Panel Button -->
  <a href="admin-login.html" class="admin-button">Admin Panel</a>

  <h1>Product Catalog</h1>
  <div id="product-grid" class="product-grid"></div>

  <!-- âœ… Place the script just before closing </body> -->
  <script>
  document.addEventListener("DOMContentLoaded", () => {
    fetch("data.php")
      .then(res => {
        if (!res.ok) throw new Error("Network response was not ok");
        return res.json();
      })
      .then(products => {
        console.log("Products loaded:", products);
        let grid = document.getElementById("product-grid");

        if (!products || products.length === 0) {
          grid.innerHTML = "<p>No products available.</p>";
          return;
        }

        products.forEach(p => {
          let card = document.createElement("div");
          card.className = "product-card";

          // Image element
          let img = document.createElement("img");
          img.src = "uploads/" + p.images[0];
          img.alt = p.name;

          // Rotate images every 2 seconds
          let current = 0;
          setInterval(() => {
            current = (current + 1) % p.images.length;
            img.src = "uploads/" + p.images[current];
          }, 2000);

          // On click, show all images (simple gallery for now)
          img.addEventListener("click", () => {
            alert("Images for " + p.name + ":\n" + p.images.join(", "));
            // Later: replace alert with a modal gallery
          });

          // Product details
          let details = document.createElement("div");
          details.innerHTML = `
            <h3>${p.name}</h3>
            <p>Material: ${p.material}</p>
            <p>Size: ${p.size}</p>
            <span>KES ${p.price}</span>
          `;

          // Add to Basket button
          let button = document.createElement("button");
          button.textContent = "Add to Basket";
          button.onclick = () => {
            addToBasket(p);
          };

          card.appendChild(img);
          card.appendChild(details);
          card.appendChild(button);
          grid.appendChild(card);
        });
      })
      .catch(err => {
        console.error("Error loading products:", err);
        document.getElementById("product-grid").innerHTML =
          "<p style='color:red;'>Failed to load products.</p>";
      });
  });

  // Basket logic (localStorage for now)
  function addToBasket(product) {
    let basket = JSON.parse(localStorage.getItem("basket")) || [];
    basket.push(product);
    localStorage.setItem("basket", JSON.stringify(basket));
    alert(product.name + " added to basket!");
  }
  </script>
</body>
</html>
